<main class="weekly-main">
  <div class="page-header">
    <h2 class="page-title">Bảng Tuần Trực Tiếp</h2>
  </div>
  
  <div class="table-container">
    <div class="table-controls">
      <button id="left-arrow" class="nav-arrow nav-arrow-left" onclick="shiftLeft()" aria-label="Tuần trước">
        <span class="arrow-icon">←</span>
        <span class="arrow-text">Trước</span>
      </button>

      <div class="table-wrapper">
        <table id="data-table" class="weekly-table">
          <thead id="table-header"></thead>
          <tbody id="data-body"></tbody>
        </table>
      </div>

      <button id="right-arrow" class="nav-arrow nav-arrow-right" onclick="shiftRight()" aria-label="Tuần sau">
        <span class="arrow-text">Sau</span>
        <span class="arrow-icon">→</span>
      </button>
    </div>
  </div>
</main>
<script src="{{ url_for('static', filename='fe_script.js') }}"></script>
<script>
  const leagueId = '{{ league_id }}'; // Replace with actual league ID
  const apiUrl = `/api/week/${leagueId}`;

  // Fetch data from the API
  fetch(apiUrl)
    .then(response => response.json())
    .then(responseData => {
      // Handle both old format (direct data array) and new format (object with data + current_week)
      if (Array.isArray(responseData)) {
        // Old format - backward compatibility
        initializeDataTable(responseData, leagueId);
      } else {
        // New format with current week info
        initializeDataTable(responseData.data, leagueId, false, responseData.current_week);
      }
    })
    .catch(error => {
      console.error('Error fetching data:', error);
      const header = document.querySelector('.page-header');
      const errorDiv = document.createElement('div');
      errorDiv.className = 'error-message';
      errorDiv.textContent = 'Lỗi tải dữ liệu. Vui lòng thử lại sau.';
      header.appendChild(errorDiv);
    });
</script>