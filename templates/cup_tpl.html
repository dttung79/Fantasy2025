    <div class="cup-container">
        <div class="loading-state" id="loading">
            <div class="skeleton skeleton-header"></div>
            <table class="skeleton-table">
                <thead>
                    <tr>
                        <th style="width: 10%;">H·∫°ng</th>
                        <th style="width: 30%;">T√™n ƒê·ªôi</th>
                        <th style="width: 10%;">Tr·∫≠n</th>
                        <th style="width: 10%;">Th·∫Øng</th>
                        <th style="width: 10%;">H√≤a</th>
                        <th style="width: 10%;">Thua</th>
                        <th style="width: 10%;">ƒêi·ªÉm</th>
                        <th style="width: 10%;">Hi·ªáu S·ªë</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                    </tr>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                    </tr>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                    </tr>
                    <tr class="skeleton-row">
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                        <td><div class="skeleton skeleton-cell"></div></td>
                    </tr>
                </tbody>
            </table>
            <div class="skeleton skeleton-card"></div>
            <div class="skeleton skeleton-card"></div>
        </div>
        
        <div id="error-message" class="error-message" style="display: none;"></div>
        
        <div id="cup-content" class="cup-content" style="display: none;">
            <!-- B·∫£ng x·∫øp h·∫°ng -->
            <section class="standings-section">
                <div class="section-header">
                    <h2 class="section-title">
                        B·∫£ng X·∫øp H·∫°ng Cup {{cup_number}}
                        <span class="week-range-badge">Tu·∫ßn {{ (cup_number - 1) * 7 + 1 }}-{{ cup_number * 7 }}</span>
                    </h2>
                    <button id="refresh-button" class="refresh-btn" onclick="refreshCupData()" aria-label="L√†m m·ªõi d·ªØ li·ªáu" style="display: none;">
                        <span class="refresh-icon">üîÑ</span>
                        <span class="refresh-text">L√†m m·ªõi</span>
                    </button>
                </div>
                <div id="toast-notification" class="toast-notification"></div>
                <div class="table-responsive">
                    <table class="standings-table" id="standings-table">
                        <thead>
                            <tr>
                                <th class="col-rank">H·∫°ng</th>
                                <th class="col-team">T√™n ƒê·ªôi</th>
                                <th class="col-stat">Tr·∫≠n</th>
                                <th class="col-stat">Th·∫Øng</th>
                                <th class="col-stat">H√≤a</th>
                                <th class="col-stat">Thua</th>
                                <th class="col-points">
                                    ƒêi·ªÉm Cup
                                    <span class="info-tooltip" title="X·∫øp h·∫°ng khi h√≤a ƒëi·ªÉm:&#10;1) ƒê·ªëi ƒë·∫ßu tr·ª±c ti·∫øp&#10;2) ƒêi·ªÉm ƒë·ªëi ƒë·∫ßu&#10;3) √çt hit h∆°n&#10;4) Hi·ªáu s·ªë">‚ÑπÔ∏è</span>
                                </th>
                                <th class="col-diff">Hi·ªáu S·ªë</th>
                            </tr>
                        </thead>
                        <tbody id="standings-body">
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- L·ªãch ƒë·∫•u v√† k·∫øt qu·∫£ -->
            <section class="schedule-section">
                <div class="section-header">
                    <h2 class="section-title">L·ªãch ƒê·∫•u & K·∫øt Qu·∫£</h2>
                </div>
                <div id="schedule-container" class="schedule-container">
                </div>
            </section>
        </div>
    </div>

    <script id="cup-data" type="application/json">{"cup_number": {{ cup_number }}}</script>
    
    <script>
        // Global variables
        let cupNumber = JSON.parse(document.getElementById('cup-data').textContent).cup_number;
        let cupData = null;
        
        // Load cup data when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadCupData();
        });
        
        async function loadCupData() {
            try {
                const response = await fetch(`/api/cup/${cupNumber}`);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                cupData = data;

                // Hide loading and show content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('cup-content').style.display = 'block';

                // Show refresh button only for current cup
                const currentWeek = data.cup_info.current_week;
                const currentCup = Math.ceil(currentWeek / 7);
                if (cupNumber === currentCup) {
                    document.getElementById('refresh-button').style.display = 'flex';
                }

                // Render cup data
                renderStandings(data.standings);
                renderSchedule(data.schedule, data.cup_info.current_week);
                
            } catch (error) {
                console.error('Error loading cup data:', error);
                showError('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu cup. Vui l√≤ng th·ª≠ l·∫°i sau.');
            }
        }
        

        
        function renderStandings(standings) {
            const tbody = document.getElementById('standings-body');
            tbody.innerHTML = '';

            standings.forEach((team, index) => {
                const row = document.createElement('tr');
                row.className = 'standings-row';

                // Add position badges for top 3
                if (index === 0) {
                    row.classList.add('position-1');
                } else if (index === 1) {
                    row.classList.add('position-2');
                } else if (index === 2) {
                    row.classList.add('position-3');
                }

                // Determine goal difference class
                let diffClass = 'col-diff';
                if (team.goal_difference > 0) {
                    diffClass += ' goal-diff-positive';
                } else if (team.goal_difference < 0) {
                    diffClass += ' goal-diff-negative';
                } else {
                    diffClass += ' goal-diff-zero';
                }

                row.innerHTML = `
                    <td class="position col-rank">${index + 1}</td>
                    <td class="team-name col-team">
                        <span class="team-name-text">${team.team_name}</span>
                    </td>
                    <td class="col-stat">${team.played}</td>
                    <td class="col-stat">${team.wins}</td>
                    <td class="col-stat">${team.draws}</td>
                    <td class="col-stat">${team.losses}</td>
                    <td class="points col-points">${team.cup_points}</td>
                    <td class="${diffClass}">${team.goal_difference > 0 ? '+' : ''}${team.goal_difference}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        function renderSchedule(schedule, currentWeek) {
            const container = document.getElementById('schedule-container');
            container.innerHTML = '';
            
            // Filter and sort weeks: only show current week and past weeks
            const allWeeks = Object.keys(schedule).map(w => parseInt(w));
            const weeksToShow = allWeeks.filter(week => week <= currentWeek);
            const sortedWeeks = weeksToShow.sort((a, b) => b - a); // Descending order (current week first)
            
            sortedWeeks.forEach(week => {
                const weekData = schedule[week];
                const weekBlock = document.createElement('div');
                weekBlock.className = `week-block ${weekData.is_current ? 'current-week' : ''}`;
                
                let matchesHtml = '';
                weekData.matches.forEach(match => {
                    const matchResult = parseMatchResult(match);
                    matchesHtml += `
                        <div class="match-card">
                            <div class="match-teams">
                                <div class="team team-left ${matchResult.team1Class}">
                                    <span class="team-name">${match.team1}</span>
                                </div>
                                <div class="match-score-container">
                                    <div class="match-score">${matchResult.scoreText}</div>
                                </div>
                                <div class="team team-right ${matchResult.team2Class}">
                                    <span class="team-name">${match.team2}</span>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                weekBlock.innerHTML = `
                    <div class="week-header">
                        <span class="week-title">Tu·∫ßn ${week}</span>
                        ${weekData.is_current ? '<span class="current-badge">(Hi·ªán t·∫°i)</span>' : ''}
                    </div>
                    <div class="matches-grid">
                        ${matchesHtml}
                    </div>
                `;
                
                container.appendChild(weekBlock);
            });
        }
        
        function parseMatchResult(match) {
            const result = match.result;
            
            if (!result || result === 'Ch∆∞a ƒë·∫•u') {
                return {
                    scoreText: 'vs',
                    team1Class: '',
                    team2Class: ''
                };
            }
            
            // Parse result format: "47-47 (H√≤a)" or "50-45 (Th·∫Øng team1)" or "45-50 (Th·∫Øng team2)"
            const scoreMatch = result.match(/(\d+)-(\d+)/);
            if (!scoreMatch) {
                return {
                    scoreText: result,
                    team1Class: '',
                    team2Class: ''
                };
            }
            
            const team1Score = parseInt(scoreMatch[1]);
            const team2Score = parseInt(scoreMatch[2]);
            
            // Format score based on match result, not just score comparison
            let scoreText;
            if (result.includes('H√≤a')) {
                // Draw - both scores in italic
                scoreText = `<em>${team1Score} - ${team2Score}</em>`;
            } else if (result.includes(`Th·∫Øng ${match.team1}`)) {
                // Team1 wins - team1 score bold
                scoreText = `<strong>${team1Score}</strong> - ${team2Score}`;
            } else if (result.includes(`Th·∫Øng ${match.team2}`)) {
                // Team2 wins - team2 score bold
                scoreText = `${team1Score} - <strong>${team2Score}</strong>`;
            } else {
                // Fallback to normal text
                scoreText = `${team1Score} - ${team2Score}`;
            }
            
            let team1Class = '';
            let team2Class = '';
            
            if (result.includes('H√≤a')) {
                team1Class = 'team-draw';
                team2Class = 'team-draw';
            } else if (result.includes(`Th·∫Øng ${match.team1}`)) {
                team1Class = 'team-win';
                team2Class = 'team-loss';
            } else if (result.includes(`Th·∫Øng ${match.team2}`)) {
                team1Class = 'team-loss';
                team2Class = 'team-win';
            }
            
            return {
                scoreText: scoreText,
                team1Class: team1Class,
                team2Class: team2Class
            };
        }
        
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error-message').textContent = message;
            document.getElementById('error-message').style.display = 'block';
        }

        function refreshCupData() {
            const refreshBtn = document.getElementById('refresh-button');
            const refreshIcon = refreshBtn.querySelector('.refresh-icon');

            // Disable button and show loading state
            refreshBtn.disabled = true;
            refreshIcon.classList.add('spinning');

            fetch(`/api/cup/${cupNumber}`)
                .then(response => {
                    if (!response.ok) throw new Error('Network response was not ok');
                    return response.json();
                })
                .then(data => {
                    cupData = data;

                    // Re-render cup data
                    renderStandings(data.standings);
                    renderSchedule(data.schedule, data.cup_info.current_week);

                    // Show success toast
                    showToast('ƒê√£ c·∫≠p nh·∫≠t d·ªØ li·ªáu', 'success');
                })
                .catch(error => {
                    console.error('Error refreshing cup data:', error);
                    showToast('L·ªói khi l√†m m·ªõi d·ªØ li·ªáu', 'error');
                })
                .finally(() => {
                    // Re-enable button and stop spinning
                    refreshBtn.disabled = false;
                    refreshIcon.classList.remove('spinning');
                });
        }

        function showToast(message, type) {
            const toast = document.getElementById('toast-notification');
            toast.textContent = message;
            toast.className = `toast-notification toast-${type} toast-show`;

            setTimeout(() => {
                toast.classList.remove('toast-show');
            }, 3000);
        }
    </script>
